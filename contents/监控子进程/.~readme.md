# 等待子进程

## 系统调用 `wait()`

```
#include <sys/types.h>
#include <sys/wait.h>

pid_t wait(int *wstatus);
```

- 如果调用 `wait()`  时已经有子进程终止，`wait()` 将立即返回，否则，子进程将一直阻塞，直至某个进程终止
- 如果 `wstatus` 非空，那么关于子进程如何终止的信息则会通过 `wstatus` 指向的整型变量返回
- 内核将会为父进程下所有子进程的运行总量追加 CPU 时间以及资源使用数据
- 将终止子进程的  ID 作为 `wait()` 的结果返回
- 出错时，返回 -1，可能的原因之一是调用进程没有被等待的子进程，此时将设置错误 `ECHILD`，所以可以使用循环来等待调用进程的所有子进程退出：

````
while((childPid == wait(NULL)) == -1)
	continue;
if(errno != ECHILD)
	errExit("wait");
````

## 系统调用 `waitpid()`

```
#include <sys/types.h>
#include <sys/wait.h>

pid_t waitpid(pid_t pid, int *wstatus, int options);
```















