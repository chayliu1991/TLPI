System V 共享内存和共享文件映射允许无关进程共享内存区域以便执行 IPC 技术，这两种技术都存在一些不足：

- System V 共享内存模型使用的是 `key` 和标识符，这与标准的 Unix IO 模型使用文件名和描述符的做法是不一致的。这种差异意味着使用 System V 共享内存段需要一整套系统调用和命名
- 使用一个共享文件映射来进行 IPC 要求创建一个磁盘文件，即使无需对共享区域进行持久存储也需要这样做。除了因为需要创建文件所带来的的不便之外，这种技术还会带来一些文件 IO 开销

# 概述

POSIX 共享内存能够让无关进程共享一个映射区域而无需创建一个相应的映射文件。Linux 从内核2.4开始支持 POSIX 共享内存。

要使用 POSIX 共享内存对象需要完成下列任务：

- 使用 `shm_open()` 函数打开一个与指定的名字对应的对象。`shm_open()` 函数与 `open()` 系统调用类似，它会创建一个新共享对象或打开一个既有对象。作为函数结果，`shm_open()` 会返回一个引用该对象的文件描述符
- 将上一步中获得的文件描述符传入 `mmap()` 调用并在其 `flags` 参数中指定 `MAP_SHARED`。这将共享内存对象映射进进程的虚拟地址空间。与 `mmap()` 一样，一旦映射了对象之后就能够关闭该文件描述符而不会影响到这个映射。然而，有可能需要将这个文件描述符保持在打开状态以便后续的 `fstat()` 和 `ftruncate()` 调用使用这个文件描述符

由于共享内存对象的引用是通过文件描述符来完成的，因此可以直接使用 Unix 系统中已经定义好的各种文件描述符系统调用（如 `ftruncate()`）而无需增加新的用途特殊的系统调用（System V 共享内存就需要这样做）。

























